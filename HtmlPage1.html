<!DOCTYPE html>
<html>
<head>
    <title>Test</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" />
    <link href="includes/Style.css" rel="stylesheet" />
    <script src="includes/jquery.min.js"></script>
    <script src="includes/bootstrap.min.js"></script>
    <script src="scripts/monaco-editor/min/vs/loader.js"></script>

    <script>
        var jsondocumentid_doc1 = [
                                                   {
                                                       "id": "1234",
                                                       "playerId": "a067ff",
                                                       "hashedId": "bb0091",
                                                       "countryCode": "hk",
                                                       "nickname": "DannyBoy",
                                                       "nicknameLower": "dannyboy",
                                                       "score": 0,
                                                       "secondaryScore": 18,
                                                       "indexScore": 0.18,
                                                       "level": 1,
                                                       "lastSaveUnixTime": 1446591499,
                                                       "lastLoadUnixTime": 1446590552,
                                                       "disconnectedUnixTime": 1446591499,
                                                       "facebookId": "FB_1010006092353214",
                                                       "gameCenterId": "GC_G:1939511430",
                                                       "chatMessages": [
                                                         {
                                                             "playerId": "67879d8e",
                                                             "name": "lee",
                                                             "message": "hi",
                                                             "time": 760455049,
                                                             "notificationType": "None"
                                                         }
                                                       ],
                                                       "foo": 364
                                                   },
                                                    {
                                                        "id": "2345",
                                                        "playerId": "a067ff",
                                                        "hashedId": "bb0091",
                                                        "countryCode": "hk",
                                                        "nickname": "DannyBoy",
                                                        "nicknameLower": "dannyboy",
                                                        "score": 0,
                                                        "secondaryScore": 18,
                                                        "indexScore": 0.18,
                                                        "level": 1,
                                                        "lastSaveUnixTime": 1446591499,
                                                        "lastLoadUnixTime": 1446590552,
                                                        "disconnectedUnixTime": 1446591499,
                                                        "facebookId": "FB_1010006092353214",
                                                        "gameCenterId": "GC_G:1939511430",
                                                        "chatMessages": [
                                                          {
                                                              "playerId": "67879d8e",
                                                              "name": "lee",
                                                              "message": "hi",
                                                              "time": 760455049,
                                                              "notificationType": "None"
                                                          }
                                                        ],
                                                        "foo": 111
                                                    },
                                                    {
                                                        "id": "7788",
                                                        "playerId": "a067ff",
                                                        "hashedId": "bb0091",
                                                        "countryCode": "hk",
                                                        "nickname": "DannyBoy",
                                                        "nicknameLower": "dannyboy",
                                                        "score": 0,
                                                        "secondaryScore": 18,
                                                        "indexScore": 0.18,
                                                        "level": 1,
                                                        "lastSaveUnixTime": 1446591499,
                                                        "lastLoadUnixTime": 1446590552,
                                                        "disconnectedUnixTime": 1446591499,
                                                        "facebookId": "FB_1010006092353214",
                                                        "gameCenterId": "GC_G:1939511430",
                                                        "chatMessages": [
                                                          {
                                                              "playerId": "67879d8e",
                                                              "name": "lee",
                                                              "message": "hi",
                                                              "time": 760455049,
                                                              "notificationType": "None"
                                                          }
                                                        ],
                                                        "foo": 222
                                                    },
                                                    {
                                                        "id": "9999",
                                                        "playerId": "a067ff",
                                                        "hashedId": "bb0091",
                                                        "countryCode": "hk",
                                                        "nickname": "DannyBoy",
                                                        "nicknameLower": "dannyboy",
                                                        "score": 0,
                                                        "secondaryScore": 18,
                                                        "indexScore": 0.18,
                                                        "level": 1,
                                                        "lastSaveUnixTime": 1446591499,
                                                        "lastLoadUnixTime": 1446590552,
                                                        "disconnectedUnixTime": 1446591499,
                                                        "facebookId": "FB_1010006092353214",
                                                        "gameCenterId": "GC_G:1939511430",
                                                        "chatMessages": [
                                                          {
                                                              "playerId": "67879d8e",
                                                              "name": "lee",
                                                              "message": "hi",
                                                              "time": 760455049,
                                                              "notificationType": "None"
                                                          }
                                                        ],
                                                        "foo": 999
                                                    },
                                                    {
                                                        "id": "9889",
                                                        "playerId": "a067ff",
                                                        "hashedId": "bb0091",
                                                        "countryCode": "hk",
                                                        "nickname": "DannyBoy",
                                                        "nicknameLower": "dannyboy",
                                                        "score": 0,
                                                        "secondaryScore": 18,
                                                        "indexScore": 0.18,
                                                        "level": 1,
                                                        "lastSaveUnixTime": 1446591499,
                                                        "lastLoadUnixTime": 1446590552,
                                                        "disconnectedUnixTime": 1446591499,
                                                        "facebookId": "FB_1010006092353214",
                                                        "gameCenterId": "GC_G:1939511430",
                                                        "chatMessages": [
                                                          {
                                                              "playerId": "67879d8e",
                                                              "name": "lee",
                                                              "message": "hi",
                                                              "time": 760455049,
                                                              "notificationType": "None"
                                                          }
                                                        ],
                                                        "foo": 939
                                                    },
                                                    {
                                                        "id": "5599",
                                                        "playerId": "a067ff",
                                                        "hashedId": "bb0091",
                                                        "countryCode": "hk",
                                                        "nickname": "DannyBoy",
                                                        "nicknameLower": "dannyboy",
                                                        "score": 0,
                                                        "secondaryScore": 18,
                                                        "indexScore": 0.18,
                                                        "level": 1,
                                                        "lastSaveUnixTime": 1446591499,
                                                        "lastLoadUnixTime": 1446590552,
                                                        "disconnectedUnixTime": 1446591499,
                                                        "facebookId": "FB_1010006092353214",
                                                        "gameCenterId": "GC_G:1939511430",
                                                        "chatMessages": [
                                                          {
                                                              "playerId": "67879d8e",
                                                              "name": "lee",
                                                              "message": "hi",
                                                              "time": 760455049,
                                                              "notificationType": "None"
                                                          }
                                                        ],
                                                        "foo": 128
                                                    },
                                                    {
                                                        "id": "2345",
                                                        "playerId": "a067ff",
                                                        "hashedId": "bb0091",
                                                        "countryCode": "hk",
                                                        "nickname": "DannyBoy",
                                                        "nicknameLower": "dannyboy",
                                                        "score": 0,
                                                        "secondaryScore": 18,
                                                        "indexScore": 0.18,
                                                        "level": 1,
                                                        "lastSaveUnixTime": 1446591499,
                                                        "lastLoadUnixTime": 1446590552,
                                                        "disconnectedUnixTime": 1446591499,
                                                        "facebookId": "FB_1010006092353214",
                                                        "gameCenterId": "GC_G:1939511430",
                                                        "chatMessages": [
                                                          {
                                                              "playerId": "67879d8e",
                                                              "name": "lee",
                                                              "message": "hi",
                                                              "time": 760455049,
                                                              "notificationType": "None"
                                                          }
                                                        ],
                                                        "foo": 111
                                                    },
                                                    {
                                                        "id": "7788",
                                                        "playerId": "a067ff",
                                                        "hashedId": "bb0091",
                                                        "countryCode": "hk",
                                                        "nickname": "DannyBoy",
                                                        "nicknameLower": "dannyboy",
                                                        "score": 0,
                                                        "secondaryScore": 18,
                                                        "indexScore": 0.18,
                                                        "level": 1,
                                                        "lastSaveUnixTime": 1446591499,
                                                        "lastLoadUnixTime": 1446590552,
                                                        "disconnectedUnixTime": 1446591499,
                                                        "facebookId": "FB_1010006092353214",
                                                        "gameCenterId": "GC_G:1939511430",
                                                        "chatMessages": [
                                                          {
                                                              "playerId": "67879d8e",
                                                              "name": "lee",
                                                              "message": "hi",
                                                              "time": 760455049,
                                                              "notificationType": "None"
                                                          }
                                                        ],
                                                        "foo": 222
                                                    },
                                                    {
                                                        "id": "9999",
                                                        "playerId": "a067ff",
                                                        "hashedId": "bb0091",
                                                        "countryCode": "hk",
                                                        "nickname": "DannyBoy",
                                                        "nicknameLower": "dannyboy",
                                                        "score": 0,
                                                        "secondaryScore": 18,
                                                        "indexScore": 0.18,
                                                        "level": 1,
                                                        "lastSaveUnixTime": 1446591499,
                                                        "lastLoadUnixTime": 1446590552,
                                                        "disconnectedUnixTime": 1446591499,
                                                        "facebookId": "FB_1010006092353214",
                                                        "gameCenterId": "GC_G:1939511430",
                                                        "chatMessages": [
                                                          {
                                                              "playerId": "67879d8e",
                                                              "name": "lee",
                                                              "message": "hi",
                                                              "time": 760455049,
                                                              "notificationType": "None"
                                                          }
                                                        ],
                                                        "foo": 999
                                                    },
                                                    {
                                                        "id": "9999",
                                                        "playerId": "a067ff",
                                                        "hashedId": "bb0091",
                                                        "countryCode": "hk",
                                                        "nickname": "DannyBoy",
                                                        "nicknameLower": "dannyboy",
                                                        "score": 0,
                                                        "secondaryScore": 18,
                                                        "indexScore": 0.18,
                                                        "level": 1,
                                                        "lastSaveUnixTime": 1446591499,
                                                        "lastLoadUnixTime": 1446590552,
                                                        "disconnectedUnixTime": 1446591499,
                                                        "facebookId": "FB_1010006092353214",
                                                        "gameCenterId": "GC_G:1939511430",
                                                        "chatMessages": [
                                                          {
                                                              "playerId": "67879d8e",
                                                              "name": "lee",
                                                              "message": "hi",
                                                              "time": 760455049,
                                                              "notificationType": "None"
                                                          }
                                                        ],
                                                        "foo": 907
                                                    }
        ];
        var jsondocumentid_doc2 = [
                                                 {
                                                     "id": "0001",
                                                     "playerId": "a067ff",
                                                     "hashedId": "bb0091",
                                                     "countryCode": "hk",
                                                     "nickname": "DannyBoy",
                                                     "nicknameLower": "dannyboy",
                                                     "score": 0,
                                                     "secondaryScore": 18,
                                                     "indexScore": 0.18,
                                                     "level": 1,
                                                     "lastSaveUnixTime": 1446591499,
                                                     "lastLoadUnixTime": 1446590552,
                                                     "disconnectedUnixTime": 1446591499,
                                                     "facebookId": "FB_1010006092353214",
                                                     "gameCenterId": "GC_G:1939511430",
                                                     "chatMessages": [
                                                       {
                                                           "playerId": "67879d8e",
                                                           "name": "lee",
                                                           "message": "hi",
                                                           "time": 760455049,
                                                           "notificationType": "None"
                                                       }
                                                     ],
                                                     "foo": 364
                                                 },
                                                   {
                                                       "id": "0002",
                                                       "playerId": "a067ff",
                                                       "hashedId": "bb0091",
                                                       "countryCode": "hk",
                                                       "nickname": "DannyBoy",
                                                       "nicknameLower": "dannyboy",
                                                       "score": 0,
                                                       "secondaryScore": 18,
                                                       "indexScore": 0.18,
                                                       "level": 1,
                                                       "lastSaveUnixTime": 1446591499,
                                                       "lastLoadUnixTime": 1446590552,
                                                       "disconnectedUnixTime": 1446591499,
                                                       "facebookId": "FB_1010006092353214",
                                                       "gameCenterId": "GC_G:1939511430",
                                                       "chatMessages": [
                                                         {
                                                             "playerId": "67879d8e",
                                                             "name": "lee",
                                                             "message": "hi",
                                                             "time": 760455049,
                                                             "notificationType": "None"
                                                         }
                                                       ],
                                                       "foo": 111
                                                   },
                                                   {
                                                       "id": "0003",
                                                       "playerId": "a067ff",
                                                       "hashedId": "bb0091",
                                                       "countryCode": "hk",
                                                       "nickname": "DannyBoy",
                                                       "nicknameLower": "dannyboy",
                                                       "score": 0,
                                                       "secondaryScore": 18,
                                                       "indexScore": 0.18,
                                                       "level": 1,
                                                       "lastSaveUnixTime": 1446591499,
                                                       "lastLoadUnixTime": 1446590552,
                                                       "disconnectedUnixTime": 1446591499,
                                                       "facebookId": "FB_1010006092353214",
                                                       "gameCenterId": "GC_G:1939511430",
                                                       "chatMessages": [
                                                         {
                                                             "playerId": "67879d8e",
                                                             "name": "lee",
                                                             "message": "hi",
                                                             "time": 760455049,
                                                             "notificationType": "None"
                                                         }
                                                       ],
                                                       "foo": 222
                                                   },
                                                   {
                                                       "id": "0007",
                                                       "playerId": "a067ff",
                                                       "hashedId": "bb0091",
                                                       "countryCode": "hk",
                                                       "nickname": "DannyBoy",
                                                       "nicknameLower": "dannyboy",
                                                       "score": 0,
                                                       "secondaryScore": 18,
                                                       "indexScore": 0.18,
                                                       "level": 1,
                                                       "lastSaveUnixTime": 1446591499,
                                                       "lastLoadUnixTime": 1446590552,
                                                       "disconnectedUnixTime": 1446591499,
                                                       "facebookId": "FB_1010006092353214",
                                                       "gameCenterId": "GC_G:1939511430",
                                                       "chatMessages": [
                                                         {
                                                             "playerId": "67879d8e",
                                                             "name": "lee",
                                                             "message": "hi",
                                                             "time": 760455049,
                                                             "notificationType": "None"
                                                         }
                                                       ],
                                                       "foo": 907
                                                   }
        ];
        var jsontreedata = [
                   {
                       name: 'Database1',
                       id: "db1",
                       children: [
                           {
                               name: 'Collections',
                               id: "col1"
                           }
                       ]
                   },
                     {
                         name: 'Database2',
                         id: "db2",
                         children: [
                             {
                                 name: 'Collections',
                                 id: "col2"
                             }
                         ]
                     }
        ];

        $(document).ready(function () {
            formTreeMenuFromJsonFile();
            treeStyles();
            showDocuments("col1"); //Show first collection by default

            $("#minislide").click(function (e) {
                $(".tt").addClass("open-sidebar");
                e.preventDefault();
                $("#mainslide").show();
                $("#minislide").hide();
            });

            $("#btnmainslide").click(function (e) {
                e.preventDefault();
                $("#minislide").show();
                $("#mainslide").hide();
            });

            $(".tt").click(function () {
                ShowDocumentsContent();
            });

            $("#tbldata").on("click", "td", function () {
                var theadid = $("#tbldata").find('thead').attr('id');

                var jsondoc = {};
                if (theadid == "col1" || theadid == "Database1")
                    jsondoc = jsondocumentid_doc1;
                if (theadid == "col2" || theadid == "Database2")
                    jsondoc = jsondocumentid_doc2;

                var selectedcolid = $(this).text();
                var jsoncoldata = getJsonIndex(jsondoc, selectedcolid);
                showMonacoEditor(jsoncoldata, theadid);
            });

            $(".spanchild").click(function () {
                var selectedcol = $(this).attr('id');
                showDocuments(selectedcol);
            });
        });

        function showMonacoEditor(jsoncoldata, theadid) {
            $("#container").empty();

            if (theadid == "col1" || theadid == "Database1")
                jsondoc = jsondocumentid_doc1[jsoncoldata];
            if (theadid == "col2" || theadid == "Database2")
                jsondoc = jsondocumentid_doc2[jsoncoldata];

            var data = JSON.stringify(jsondoc, ',', '\t');
            require.config({ paths: { 'vs': 'scripts/monaco-editor/min/vs' } });
            require(['vs/editor/editor.main'], function () {
                var editor = monaco.editor.create(document.getElementById('container'), {
                    value: [
                       data
                    ].join('\n'),
                    language: 'json'
                });
            });
        }

        function getJsonIndex(list, id) {
            for (var i = 0; i < list.length; i++) {
                if (list[i].id == id)
                    return i;
            }
        }

        function ShowDocumentsContent() {
            $("#atabName").text("Documents");
            $("#tabdocuments").show();
            $("#tabdatabase").hide();
        }

        function showDocuments(docid) {
            var jsondoc = {};  //get json document id's from api
            if (docid == "col1" || docid == "Database1")
                jsondoc = jsondocumentid_doc1;
            if (docid == "col2" || docid == "Database2")
                jsondoc = jsondocumentid_doc2;

            BindDocumentIdsToTable(jsondoc, docid); //show Id's table
            showMonacoEditor(0, docid);
        }

        function BindDocumentIdsToTable(jsondoc, dbname) {
            $("#tbldata").empty();
            var tr = [];
            tr.push('<thead id=' + dbname + '>');
            tr.push('<tr>'); tr.push('<th>Id</th>'); tr.push('</tr>');
            tr.push('</thead>');

            tr.push('<tbody  id="tbodycontent">');
            for (var i = 0; i < jsondoc.length; i++) {
                tr.push('<tr>');
                tr.push('<td>' + jsondoc[i].id + '</td>');
                tr.push('</tr>');
            }
            tr.push('</tbody>');
            $("#tbldata").append($(tr.join('')));
        }

        function formTreeMenuFromJsonFile() {
            $("#divTreeMenu").empty();
            var ul = [];
            for (var i = 0; i < jsontreedata.length; i++) {
                var parentdata = jsontreedata[i];
                ul.push('<li id="litree">');
                ul.push('<span class="spanparent"><img class="imgarrowstyle" id="imgarrow' + i + '" src="includes/sort-down.svg" /><img class="imgdocdb" src="includes/DocDB-Logo.svg" />');
                ul.push('<div id=spandbstyle>' + parentdata.name + '</div>');
                ul.push('</span>');
                for (var j = 0; j < parentdata.children.length; j++) {
                    ul.push('<ul>');
                    var selectedcollectionid = parentdata.children[j].id;
                    ul.push('<li id="lisubtree"><span id="' + selectedcollectionid + '" class="spanchild"><img class="imgdoccol" src="includes/DocumentDBCollectionsIcon.svg" />');
                    ul.push('<div id=spancolstyle>' + parentdata.children[j].name + '</div>');
                    ul.push('</span></li>');
                    ul.push('</ul>');
                }
                ul.push('</li>');
            }
            $("#divTreeMenu").append($(ul.join('')));
        }
        
        function treeStyles() {
            //  $('.tree li ul').children().hide();
            $('.tree li:has(ul)').addClass('parent_li').find(' > span').attr('title', 'Collapse this branch');
            $('.tree li.parent_li > span').on('click', function (e) {
                showDocuments($(this).text());
                setTreeMenuArrowRotation($(this).find("img").attr('id'), $(this).find("img").attr('src'));
                var children = $(this).parent('li.parent_li').find(' > ul > li');
                if (children.is(":visible")) {
                    children.hide('fast');
                    $(this).attr('title', 'Expand this branch').find(' > i').addClass('icon-plus-sign').removeClass('icon-minus-sign');
                } else {
                    children.show('fast');
                    $(this).attr('title', 'Collapse this branch').find(' > i').addClass('icon-minus-sign').removeClass('icon-plus-sign');
                }
                e.stopPropagation(); //2.3.1
            });
        }

        function setTreeMenuArrowRotation(imgarrowid, currentsrc) {
            var id = "#" + imgarrowid;
            var newsrc = (currentsrc == "includes/sort-down.svg" ? "includes/sort-right.svg" : "includes/sort-down.svg");
            $(id).attr('src', newsrc);
        }

    </script>
</head>
<body style="font-family:'Segoe UI';font-size:large;">
    <div>
        <!-- Main header Content -->
        <div class="header HeaderBg">
            <div class="items">
                <img class="DocDBicon" src="includes/DocDB-Logo.svg" />
                <span class="title">Azure Local DocumentDB</span>
                <div>
                    <a><span class="menuQuickStart">Quickstart</span></a>
                    <a><span class="menuExplorer">Explorer</span></a>
                    <a class="createdocdbacnt">CREATE A DOCUMENTDB ACCOUNT<img class="rightarrowimg" src="includes/Arrow.svg"/></a>
                </div>
            </div>
        </div>
        <!-- Second menu Content -->
        <div class="belowbg">
            <div class="adjustheight"></div>
            <span class="iconpad"><img class="submenuicons" src="includes/upload doc.svg" />ADD COLLECTION</span>
            <span class="iconpad"><img class="submenuicons" src="includes/Create Query.svg" />CREATE NEW QUERY</span>
            <span class="iconpad"><img class="submenuicons" src="includes/Open query.svg" />OPEN QUERIES</span>
        </div>
    </div>
    <div class="row">
        <div id="minislide" class="col-md-1 tt open-sidebar" style="display:none;">
            <div class="main-nav">
                <ul class="nav">
                    <li><a href="#" class="tt">Database</a></li>
                    <li><a href="#" class="tt">Collection</a></li>
                </ul>
            </div>
        </div>
        <div id="mainslide" class="col-md-2">
            <div id="sidebar-wrapper">
                <div class="verticalLine">
                    <span><img id="btnmainslide" class="pull-right" src="includes/back.svg" /></span>
                    <!--<div id="tree1"></div>-->
                    <div id="divTreeMenu" class="tree well"></div>
                </div>
            </div>
        </div>
        <div id="content" class="col-md-9">
            <div class="contentdiv">
                <ul class="nav nav-tabs level">
                    <li class="active" style="float:left;"><a data-toggle="tab" id="atabName">Documents</a></li>
                </ul><br />
                <span class="spanmenu"><img id="imgiconwidth" src="includes/refresh.svg" />Refresh</span>
                <span class="spanmenu"><img id="imgiconwidth" src="includes/upload doc.svg" />Add document</span>
                <span class="spanmenu"><img id="imgiconwidth" src="includes/create doc.svg" />Create document</span>
                <span class="spanmenu"><img id="imgiconwidth" src="includes/save.svg" />Save</span>
                <span class="spanmenu"><img id="imgiconwidth" src="includes/discard.svg" />Discard</span>
                <span class="spanmenu"><img id="imgiconwidth" src="includes/delete.svg" />Delete</span>
                <span class="spanmenu"><img id="imgiconwidth" src="includes/filter.svg" />Filter</span>
                <hr class="hrline">
            </div>
            <div class="tab-content" id="tabdocuments">
                <div class="row">
                    <div class="col-md-2" style="overflow-y:auto;height:610px;border:none;">
                        <table id="tbldata" class="table table-hover"></table>
                    </div>
                    <div class="col-md-10" id="divcontent" style="height:610px;border:none;">
                        <div id="container" style="height:600px;border-left :1px solid #d6d7d8;"></div>
                    </div>
                </div>
            </div>
            <div class="tab-content" id="tabdatabase" style="display:none;">
                <br /><br />
                <p> User defined </p>
            </div>
        </div>
    </div>
</body>
</html>
